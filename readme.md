# Онлайн-сэмплер с функцией записи и отправки звука

Интерактивный веб-инструмент, позволяющий создавать музыку с помощью 5 звуков, изменять их высоту тона, применять реверберацию, записывать композиции длительностью до 30 секунд и отправлять их по электронной почте или в Telegram.

## Содержание

- [Возможности](#возможности)
- [Установка](#установка)
- [Настройка](#настройка)
- [Запуск](#запуск)
- [Использование](#использование)
- [Структура проекта](#структура-проекта)
- [Расширение функционала](#расширение-функционала)

## Возможности

- 5 клавиш для воспроизведения звуков, с индивидуальным контролем высоты тона для каждой
- Автоматическая загрузка MP3 сэмплов из папки samples (файлы 1.mp3, 2.mp3, 3.mp3, 4.mp3, 5.mp3)
- Встроенные синтезированные звуки как резервный вариант, если сэмплы не найдены
- Эффект реверберации с регулируемой интенсивностью
- Запись звука длительностью до 30 секунд
- Отправка записей по электронной почте (через Яндекс.Почту)
- Отправка записей в Telegram с помощью бота
- Скачивание записей на устройство пользователя

## Установка

### Предварительные требования

- Node.js (версия 14 или выше)
- npm (входит в комплект Node.js)

### Шаги установки

1. Клонируйте или распакуйте проект в выбранную директорию
2. Откройте терминал и перейдите в директорию проекта
3. Выполните установку зависимостей:

```bash
npm install
```

## Настройка

### Настройка Email (Яндекс.Почта)

1. Создайте или используйте существующий аккаунт Яндекс.Почты
2. В настройках почты включите "Доступ к почтовому ящику с помощью почтовых клиентов"
3. Создайте пароль приложения (НЕ используйте основной пароль от аккаунта)
4. Откройте файл `.env` и заполните следующие поля:
   ```
   EMAIL_SERVICE=Yandex
   EMAIL_USER=your_email@yandex.ru
   EMAIL_PASS=your_app_password_here
   ```

### Настройка Telegram бота

1. Откройте Telegram и найдите @BotFather
2. Создайте нового бота с помощью команды `/newbot`
3. Получите токен бота и скопируйте его
4. Откройте файл `.env` и заполните поле:
   ```
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
   ```
5. (Опционально) Укажите ID чата по умолчанию:
   ```
   TELEGRAM_DEFAULT_CHAT_ID=your_chat_id_here
   ```

## Запуск

После настройки, запустите сервер командой:

```bash
npm start
```

Сервер запустится по адресу http://localhost:3000 (или другому порту, если вы изменили настройки в файле `.env`).

Для разработки с автоматической перезагрузкой при изменении кода используйте:

```bash
npm run dev
```

## Использование

1. Откройте браузер и перейдите по адресу http://localhost:3000
2. Используйте клавиши 1-5 или кнопки на экране для воспроизведения звуков
3. Регулируйте высоту тона для каждого звука с помощью ползунков под соответствующими кнопками
4. Настройте общую реверберацию с помощью глобального ползунка
5. Нажмите "Запись" для начала записи (максимум 30 секунд)
6. По окончании записи, выберите способ отправки:
   - **Email**: введите адрес электронной почты и нажмите "Отправить"
   - **Telegram**: введите username (@username) или ID чата и нажмите "Отправить"
   - **Скачать**: нажмите кнопку "Скачать" для сохранения на устройство

### Добавление своих звуков

1. Подготовьте 5 MP3 файлов
2. Переименуйте их в соответствии с форматом: 1.mp3, 2.mp3, 3.mp3, 4.mp3, 5.mp3
3. Поместите файлы в папку `samples/` в корне проекта
4. Перезапустите приложение или просто обновите страницу в браузере

## Структура проекта

```
online-sampler/
├── public/          # Статические файлы
│   └── index.html   # Главная страница приложения
├── samples/         # Папка для хранения MP3 сэмплов
│   ├── 1.mp3        # Сэмпл для первой клавиши
│   ├── 2.mp3        # Сэмпл для второй клавиши
│   ├── 3.mp3        # Сэмпл для третьей клавиши
│   ├── 4.mp3        # Сэмпл для четвертой клавиши
│   └── 5.mp3        # Сэмпл для пятой клавиши
├── uploads/         # Папка для временных файлов (создается автоматически)
├── .env             # Файл с переменными окружения
├── package.json     # Зависимости и скрипты
├── README.md        # Документация
└── server.js        # Серверная часть приложения
```

## Расширение функционала

### Добавление новых звуков

Для добавления новых звуков, отредактируйте массив `sounds` в файле `public/index.html`:

```javascript
const sounds = [
    // Существующие звуки...
    // Новый звук:
    { 
        frequency: 440, 
        type: 'sawtooth', 
        duration: 0.5, 
        envelope: { attack: 0.05, decay: 0.2, sustain: 0.6, release: 0.3 } 
    }
];
```

### Добавление новых эффектов

Для добавления новых звуковых эффектов, используйте Web Audio API. Например, для добавления фильтра низких частот:

```javascript
// Создаем фильтр
const lowPassFilter = audioContext.createBiquadFilter();
lowPassFilter.type = 'lowpass';
lowPassFilter.frequency.value = 1000; // Частота среза (Гц)

// Подключаем в цепочку обработки
envelope.connect(lowPassFilter);
lowPassFilter.connect(masterGain);
```

### Добавление поддержки других почтовых сервисов

Для поддержки других почтовых сервисов, отредактируйте соответствующий блок в файле `server.js` и добавьте настройки в файл `.env`.
